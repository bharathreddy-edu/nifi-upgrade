description: Upgrading Zookeeper on existing NiFi Server.
schemaVersion: '0.3'
  ZK_PORT:'{{ZookeeperPort}}',
S3_DOWNLOAD_ABSPATH: '{{S3DownloadAbsolutePath}}',
parameters:
  ZookeeperPort:
    type: String
    description: '(Required) zookeeper port, please use default port 2181, do not change it unless needed.'
    default: '2181'
  installZK:
    type: String
    description: (Required) true, if you need to install zookeeper service on the server. false, if you dont want to install zookeeper service on the server.
    allowedValues:
      - true
      - false
    default: false
  upgradeZK:
    type: String
    description: (Required) yes, if you need to upgrade zookeeper to a newer version,  no, if you are doing a fresh zookeeper installation.
    allowedValues:
      - yes
      - no
    default: yes
  S3DownloadAbsolutePath:
    type: String
    description: (Required) s3 path from where we can download the tar file (do not put / at end).
    default: 's3://dtv-bigdatadl-nifi-dev-int/NiFi_Zookeeper_Softwares/zookeeper'
  S3ZookeeperWorkingAbsolutePath:
    type: String
    description: (Required) backup location of a working zookeeper installation, do not update this path until necessary (do not put / at end).
    default: 's3://dtv-bigdatadl-nifi-dev-int/NiFi_ZK_Backups/zookeeper/apache-zookeeper-3.8.0-bin'
  ZKDownload_Filename:
    type: String
    description: (Required) apache zk tar filename, which you will be installing now.
    default: 'apache-zookeeper-3.8.0-bin.tar.gz'
  BaseZookeeperHomePth:
    type: String
    description: (Required) Base location for zookeeper installation, do not update it.
    default: '/opt/zookeeper'
  HostNamesList:
    type: String
    description: (Required) Please provide comma seperated list of all the nodes, where you gonna install zookeeper service.
    default: ''
mainSteps:
  - name: StopDisableCFEngine
    action: 'aws:runCommand'
    onFailure: Abort
    inputs:
      DocumentName: 'arn:aws:ssm:us-west-2:648428630961:document/StopDisableCFEngine'
      InstanceIds:
        - '{{InstanceId}}'
      OutputS3BucketName: '{{ReportS3Bucket}}'
