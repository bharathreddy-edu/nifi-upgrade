description: Upgrading Zookeeper on existing NiFi Server.
schemaVersion: '0.3'
  ZK_PORT:'{{ZookeeperPort}}',
S3_DOWNLOAD_ABSPATH: '{{S3DownloadAbsolutePath}}',
parameters:
  NIFIPORT:
    type: String
    description: '(Required) NiFi port, please use default port 9091, do not change it unless needed.'
    default: '9091'
  upgradeNIFI:
    type: String
    description: (Required) true, if you need to install zookeeper service on the server. false, if you dont want to install zookeeper service on the server.
    allowedValues:
      - yes
      - no
    default: no
  nifiS3DOWNLOADABSPATH:
    type: String
    description: (Required) s3 path from where we can download the tar file (do not put / at end).
    default: 's3://dtv-bigdatadl-nifi-dev-int/NiFi_Zookeeper_Softwares/nifi'
  S3nifipathworkingABSPATH:
    type: String
    description: (Required) backup location of a working NiFi installation, do not update this path until necessary (do not put / at end).
    default: 's3://dtv-bigdatadl-nifi-dev-int/NiFi_ZK_Backups/nifi/nifi-1.16.1'
  NIFI_Download_Filename:
    type: String
    description: (Required) apache zk tar filename, which you will be installing now.
    default: 'nifi-1.16.1-bin.tar.gz'
  BASENIFIHOMEPATH:
    type: String
    description: (Required) Base location for zookeeper installation, do not update it.
    default: '/opt/nifi'
  HostNamesList:
    type: String
    description: (Required) Please provide comma seperated list of all the nodes, where you gonna install zookeeper service.
    default: ''
  NIFI_SERVER_COUNT:
    type: String
    description: (Required) Please provide comma seperated list of all the nodes, where you gonna install zookeeper service.
    default: ''
mainSteps:
  - name: StopDisableCFEngine
    action: 'aws:runCommand'
    onFailure: Abort
    inputs:
      DocumentName: 'arn:aws:ssm:us-west-2:648428630961:document/StopDisableCFEngine'
      InstanceIds:
        - '{{InstanceId}}'
      OutputS3BucketName: '{{ReportS3Bucket}}'
